- name: remove exist codes files directory
  file:
    path: '{{ code.location }}'
    state: absent
  become: yes

- name: git checkout codes
  git:
    repo: '{{ code.repo }}'
    depth: 1
    version: develop
    dest: '{{ code.location }}'
    accept_hostkey: yes
    force: yes

- name: remove useless files
  file:
    path: '{{ code.location }}/.git'
    state: absent